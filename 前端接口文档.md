# 扑克牌游戏前端接口文档

## 概述

本文档描述了扑克牌游戏前端需要使用的接口，包括与服务端通信所需的方法和事件处理。前端主要通过 `GameClient` 类与服务端进行交互。

## 客户端接口 (GameClient)

### 连接与基本操作

#### 连接服务器
```java
/**
 * 连接到游戏服务器
 * @param host 服务器地址
 * @throws IOException 连接失败时抛出异常
 */
public void connect(String host) throws IOException;
```

#### 加入游戏
```java
/**
 * 加入游戏，发送玩家信息到服务器
 * @param playerName 玩家名称
 */
public void joinGame(String playerName);
```

#### 断开连接
```java
/**
 * 断开与服务器的连接
 */
public void disconnect();
```

#### 状态检查
```java
/**
 * 检查是否已连接到服务器
 * @return 是否已连接
 */
public boolean isConnected();

/**
 * 检查游戏是否已开始
 * @return 游戏是否已开始
 */
public boolean isGameStarted();

/**
 * 检查游戏是否已结束
 * @return 游戏是否已结束
 */
public boolean isGameEnded();
```

### 游戏操作

#### 出牌
```java
/**
 * 发送出牌请求到服务器
 * @param cards 要出的牌列表
 */
public void playCards(List<Card> cards);
```

#### 过牌
```java
/**
 * 发送过牌请求到服务器
 */
public void pass();
```

#### 检查出牌有效性
```java
/**
 * 检查当前出牌是否有效
 * @param cards 要检查的牌列表
 * @return 是否是有效的出牌
 */
public boolean canPlay(List<Card> cards);

/**
 * 获取当前手牌中所有可能的有效出牌组合
 * @param hand 当前手牌
 * @return 所有可能的有效出牌组合列表
 */
public List<List<Card>> getValidPlays(List<Card> hand);
```

### 游戏状态获取

#### 获取游戏规则
```java
/**
 * 获取当前游戏规则
 * @return 当前游戏规则
 */
public Rule getCurrentRule();
```

#### 获取上一手牌
```java
/**
 * 获取上一手出的牌
 * @return 上一手出的牌列表
 */
public List<Card> getLastPlayedCards();
```

#### 获取玩家信息
```java
/**
 * 获取当前回合玩家ID
 * @return 当前回合玩家ID
 */
public String getCurrentPlayerId();

/**
 * 获取上一个出牌玩家ID
 * @return 上一个出牌玩家ID
 */
public String getLastPlayerId();

/**
 * 获取本地玩家信息
 * @return 本地玩家对象
 */
public NetworkPlayer getLocalPlayer();
```

### 事件监听

#### 添加游戏状态监听器
```java
/**
 * 添加游戏状态变化监听器
 * @param listener 监听器对象
 */
public void addStateListener(GameStateListener listener);
```

#### 移除游戏状态监听器
```java
/**
 * 移除游戏状态变化监听器
 * @param listener 要移除的监听器对象
 */
public void removeStateListener(GameStateListener listener);
```

#### 游戏事件枚举
```java
/**
 * 游戏事件类型
 */
public enum GameEvent {
    CONNECTED,       // 连接到服务器
    DISCONNECTED,    // 断开连接
    GAME_STARTED,    // 游戏开始
    CARD_PLAYED,     // 有玩家出牌
    GAME_ENDED       // 游戏结束
}
```

#### 游戏状态监听器接口
```java
/**
 * 游戏状态监听器接口
 */
public interface GameStateListener {
    /**
     * 当游戏状态发生变化时调用
     * @param event 游戏事件类型
     */
    void onGameStateChanged(GameEvent event);
}
```

## 使用示例

### 连接服务器并加入游戏
```java
GameClient client = new GameClient();
try {
    client.connect("192.168.1.100");
    client.joinGame("玩家1");
} catch (IOException e) {
    System.err.println("连接服务器失败: " + e.getMessage());
}
```

### 添加游戏状态监听器
```java
client.addStateListener(new GameClient.GameStateListener() {
    @Override
    public void onGameStateChanged(GameClient.GameEvent event) {
        switch (event) {
            case CONNECTED:
                System.out.println("已连接到服务器");
                break;
            case GAME_STARTED:
                System.out.println("游戏已开始");
                break;
            case CARD_PLAYED:
                List<Card> lastCards = client.getLastPlayedCards();
                String playerId = client.getLastPlayerId();
                System.out.println("玩家 " + playerId + " 出牌: " + lastCards);
                break;
            case GAME_ENDED:
                System.out.println("游戏已结束");
                break;
            case DISCONNECTED:
                System.out.println("与服务器断开连接");
                break;
        }
    }
});
```

### 出牌操作
```java
List<Card> cardsToPlay = new ArrayList<>();
// 添加要出的牌...
if (client.canPlay(cardsToPlay)) {
    client.playCards(cardsToPlay);
} else {
    System.out.println("无效的出牌");
}
```

### 获取有效出牌组合
```java
List<Card> hand = player.getHand();
List<List<Card>> validPlays = client.getValidPlays(hand);
System.out.println("可用的出牌组合: " + validPlays.size());
```

## 注意事项

1. 所有网络操作可能会抛出异常，请确保适当处理这些异常。
2. 在调用出牌方法前，应先使用 `canPlay()` 方法检查出牌是否有效。
3. 游戏状态变化通过监听器通知，请确保在适当的时机添加监听器。
4. 断开连接时，应调用 `disconnect()` 方法以释放资源。 